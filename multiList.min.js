!function(t){t.fn.multiList=function(i){var e,a,n,s,l=this,d=[],o=this,c={orientation:"vertical",itemActions:!1,itemImage:!1,icon:!1,placeholder:"Select options"},u=t.extend({},c,i);u.orientation=u.orientation.charAt(0).toUpperCase(),u.itemImage&&(u.orientation="H"),l.initOptionsValues=function(){var i=1;o.find("option").each(function(e){t(this).attr("data-multiList-id",i),i++})},l.createInterface=function(){var i="";u.itemImage&&(i="multiListImages");var l="";l+='<div id="'+s+'" class="multiListContainer">',l+='<div class="multiListNestable '+i+" multiList"+u.orientation+' dd"><ol class="dd-list clearfix"></ol></div>',l+='<div class="multiListSelect2"></div>',l+="</div>",t(this).before(l),e=t("#"+s),a=e.find(".multiListNestable"),n=e.find(".multiListSelect2"),n.append(o)},l.getSelectedValues=function(){d=[],o.find("option:selected").each(function(i){var e={id:t(this).attr("data-multiList-id"),name:t(this).text(),weight:t(this).attr("data-order"),value:t(this).val()};u.itemImage&&(e.image=t(this).attr("data-image")),d.push(e)}),o.find("option").not("option:selected").attr("data-order",parseInt(d.length+1)),d.sort(function(t,i){return parseInt(t.weight)-parseInt(i.weight)})},l.getMultilistItem=function(i){return t.grep(d,function(t){return t.id==i})[0]},l.execNestable=function(){a.find(".dd-list").html(""),d.length>0&&(t.each(d,function(i,e){var n='<li class="dd-item" data-id="'+e.id+'">';n+='<div class="unselectNestable">X</div>',u.itemActions&&(n+='<ul class="dd-multiListActions clearfix">',t.each(u.itemActions,function(t,i){n+='<li class="dd-multiList-action-'+i.id+'" data-action-id="'+i.id+'">',n+=i.html,n+="</li>"}),n+="</ul>"),n+='<div class="dd-handle">',n+='<div class="dd-multiListIcon">',u.icon&&(n+=u.icon),n+="</div>",u.itemImage&&(n+='<div class="multiListImage"><img class="img-responsive" src="'+e.image+'"></div>'),n+='<div class="multiListText">'+e.name+"</div>",n+="</div>",n+="</li>",a.find(".dd-list").append(n),o.find('option[data-multiList-id="'+e.id+'"]').attr("data-order",i)}),a.find(".unselectNestable").on("click",function(i){var e=t(this).parent().attr("data-id");o.find('option[data-multiList-id="'+e+'"]').attr("selected",!1),t(this).parent().remove(),i.stopPropagation()}));var i="";u.itemImage&&(i="multiListImages");var e;e="V"===u.orientation?s+" multiListDragel "+i:s+" multiListDragel "+i+" multiList"+u.orientation,a.nestable({dragClass:e,maxDepth:1,group:s,callback:function(i,e){var n=a.nestable("serialize");t.each(n,function(t,i){o.find('option[data-multiList-id="'+i.id+'"]').attr("data-order",t)})}})},l.execSelect2=function(){o.select2({tags:"true",placeholder:u.placeholder})},l.reloadMultiList=function(){l.initOptionsValues(),l.getSelectedValues(),l.execNestable(),l.reloadBinds()},l.multiListBinds=function(){o.on("change",function(t){l.reloadMultiList()}),l.realoadBinds()},l.reloadBinds=function(){u.itemActions&&a.find(".dd-multiListActions li").on("click",function(i){var e=t(i.currentTarget).attr("data-action-id");t.each(u.itemActions,function(a,n){e===n.id&&n.action(l.getMultilistItem(t(i.currentTarget).closest("li.dd-item").attr("data-id")))})})},l.init=function(){"undefined"!=typeof multiListCount?multiListCount++:multiListCount=1,s="multiListId-"+multiListCount,l.initOptionsValues(),l.getSelectedValues(),l.createInterface(),l.execSelect2(),l.execNestable(),l.multiListBinds()},l.init()},t.fn.multiMultiList=function(i){t(this).each(function(e){t(this).multiList(i)})}}(jQuery);
