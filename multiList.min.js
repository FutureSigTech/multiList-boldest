!function(t){t.fn.multiList=function(i){var e,n,a,s,l=this,d=[],o=this,c={orientation:"vertical",placeholder:"Select options"},u=t.extend({},c,i);u.orientation=u.orientation.charAt(0).toUpperCase(),l.initOptionsValues=function(){var i=1;o.find("option").each(function(){t(this).attr("data-multiList-id",i),i++})},l.createInterface=function(){var i="";i+='<div id="'+s+'" class="multiListContainer">',i+='<div class="multiListNestable multiList'+u.orientation+' dd"><ol class="dd-list clearfix"></ol></div>',i+='<div class="multiListSelect2"></div>',i+="</div>",t(this).before(i),e=t("#"+s),n=e.find(".multiListNestable"),a=e.find(".multiListSelect2"),a.append(o)},l.getSelectedValues=function(){d=[],o.find("option:selected").each(function(){d.push({id:t(this).attr("data-multiList-id"),name:t(this).text(),weight:t(this).attr("data-order")})}),o.find("option").not("option:selected").attr("data-order",parseInt(d.length+1)),d.sort(function(t,i){return parseInt(t.weight)-parseInt(i.weight)})},l.execNestable=function(){n.find(".dd-list").html(""),d.length>0&&(t.each(d,function(t,i){var e='<li class="dd-item" data-id="'+i.id+'">';e+='<div class="unselectNestable">X</div>',e+='<div class="dd-handle">'+i.name+"</div>",e+="</li>",n.find(".dd-list").append(e),o.find('option[data-multiList-id="'+i.id+'"]').attr("data-order",t)}),n.find(".unselectNestable").on("click",function(i){var e=t(this).parent().attr("data-id");o.find('option[data-multiList-id="'+e+'"]').attr("selected",!1),t(this).parent().remove(),i.stopPropagation()}));var i;i="V"===u.orientation?"multiListDragel":"multiListDragel multiList"+u.orientation,n.nestable({dragClass:i,maxDepth:1,group:s,callback:function(){var i=n.nestable("serialize");t.each(i,function(t,i){o.find('option[data-multiList-id="'+i.id+'"]').attr("data-order",t)})}})},l.execSelect2=function(){o.select2({tags:"true",placeholder:u.placeholder})},l.multiListBinds=function(){o.on("change",function(){l.getSelectedValues(),l.execNestable()}),n.on("click",function(){o.select2("open")})},l.init=function(){"undefined"!=typeof multiListCount?multiListCount++:multiListCount=1,s="multiListId-"+multiListCount,l.initOptionsValues(),l.getSelectedValues(),l.createInterface(),l.execSelect2(),l.execNestable(),l.multiListBinds()},l.init()},t.fn.multiMultiList=function(i){t(this).each(function(){t(this).multiList(i)})}}(jQuery);
